{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mx-auto max-w-3xl py-10">

  {# flash messages so gateway errors are visible #}
  {% if messages %}
    <div class="mb-4">
      {% for message in messages %}
        <div class="my-2 p-3 rounded border
          {% if message.tags == 'error' %} border-rose-300 bg-rose-50 text-rose-800
          {% elif message.tags == 'success' %} border-emerald-300 bg-emerald-50 text-emerald-800
          {% else %} border-slate-300 bg-slate-50 text-slate-800 {% endif %}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <h1 class="text-3xl font-bold mb-6">Choose Payment Method</h1>

  <div class="bg-white shadow rounded-lg p-6 mb-6">
    <h2 class="text-xl font-semibold mb-3">Order Summary</h2>
    <ul class="divide-y">
      {% for it in items %}
        <li class="py-3 flex justify-between">
          <span>{{ it.name }} × {{ it.qty }}</span>
          <span>{{ it.unit_price }} {{ currency }}</span>
        </li>
      {% endfor %}
    </ul>
    <div class="mt-4 text-right text-lg font-bold">
      Subtotal: {{ subtotal }} {{ currency }}
    </div>
  </div>

  <div class="grid md:grid-cols-2 gap-4">

    <!-- SSLCOMMERZ (active) -->
    <form action="{% url 'pay_with_sslcommerz' %}" method="post" class="bg-white shadow rounded-lg p-6">
      {% csrf_token %}
      <h3 class="text-lg font-semibold mb-3">Bangladeshi (SSLCOMMERZ)</h3>
      <p class="text-sm text-gray-600 mb-4">Local gateways (বিকাশ/কার্ড ইত্যাদি)।</p>
      <button class="w-full px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">
        Pay with SSLCOMMERZ
      </button>
    </form>

    <!-- Coin placeholder -->
    <form action="{% url 'pay_with_coin' %}" method="post" class="bg-white shadow rounded-lg p-6">
      {% csrf_token %}
      <h3 class="text-lg font-semibold mb-3">Coin (Coming soon)</h3>
      <p class="text-sm text-gray-600 mb-4">Pay directly to wallet (manual verify).</p>
      <button class="w-full px-4 py-2 rounded bg-gray-300 text-gray-700 cursor-not-allowed" disabled>
        Coming Soon
      </button>
    </form>

  </div>

  <div class="mt-6">
    <a href="{% url 'cart_view' %}" class="text-blue-600 hover:underline">← Back to cart</a>
  </div>
</div>
{% endblock %}
